System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(H,L){"use strict";var m,y,v,w;return{setters:[function(u){m=u.a,y=u.o,v=u.k},function(u){w=u.A}],execute:function(){var u=Object.defineProperty,_=(t,e)=>u(t,"name",{value:e,configurable:!0});function A(t){const e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",t.name),e.setAttribute("value",t.value),e}_(A,"copyInput");function j(t){let e=!1;const r=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),o=r.length!==0?JSON.parse(r[0].getAttribute("data-numbers")||"[]"):[];for(const n of t.querySelectorAll(".js-scanning-bulk-action-items")){n.innerHTML="";const s=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const c of s)e||(e=o.indexOf(parseInt(c.value))!==-1),n.appendChild(A(c))}for(const n of t.querySelectorAll(".js-scanning-reopen-button"))n.hidden=e;for(const n of t.querySelectorAll(".js-scanning-reopen-button-disabled"))n.hidden=!e}_(j,"copyCheckedAlertsToBulkActionForms"),m("change",".js-scanning-alert-check",function({currentTarget:t}){const e=t.closest(".js-scanning-alert-list"),r=e.querySelector(".js-scanning-alert-check:checked")!=null,o=e.querySelector(".js-scanning-filter-options"),n=e.querySelector(".js-scanning-alert-bulk-actions"),s=e.querySelector(".js-scanning-alert-links");o&&(o.hidden=r),n&&(n.hidden=!r),s&&(s.hidden=r),j(e)}),m("details-menu-selected",".js-scanning-code-path-menu",function(t){const e=t.detail.relatedTarget.getAttribute("data-target-code-path");for(const r of document.querySelectorAll(".js-scanning-code-path"))r.hidden=e!==r.getAttribute("data-code-path")},{capture:!0});var P=Object.defineProperty,a=(t,e)=>P(t,"name",{value:e,configurable:!0});y(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const t=document.querySelector(".js-post-processing-expression-count");t&&t.textContent&&(window.postProcessingExpressionCount=parseInt(t.textContent))}}),m("click",".js-add-secret-format-button",t=>{const e=t.currentTarget;if(!!e&&window.postProcessingExpressionCount<f()){const r=document.querySelectorAll(".js-additional-secret-format");if(!r)return;for(const o of r)if(o.classList.contains("has-removed-contents")){o.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===f()&&(e.hidden=!0);break}}}),m("click",".js-remove-secret-format-button",t=>{var e,r;const o=document.querySelector(".js-add-secret-format-button");if(!o)return;const n=t.currentTarget;if(!n)return;const s=n.closest(".js-additional-secret-format");if(!s)return;s.classList.toggle("has-removed-contents",!0);const c=s.getElementsByClassName("js-post-processing-input")[0];c.value="";const i=Array.from(s.getElementsByClassName("js-post-processing-input-rule")),d=s.getElementsByClassName("errored")[0];d&&d.classList.toggle("errored",!1);for(const S of i)(e=document.getElementById(`${S.id}_hidden`))==null||e.remove();(r=document.getElementById(`${c.id}_hidden`))==null||r.remove(),h(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<f()&&(o.hidden=!1)}),y(".js-test-code",{async add(){const t=document.querySelector(".js-test-code"),e=t.clientHeight,r=await L.import("./chunk-codemirror.js").then(function(o){return o.c});if(window.codeEditor=r.default.fromTextArea(t,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:t.value,lineSeparator:`\r
`,theme:"github-light"}),e!==0){const o=document.querySelector(".CodeMirror");o&&(o.style.height=`${e}px`,o.style.border="1px solid #e1e4e8",o.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",()=>{h(window.codeEditor.getValue())})}}),w(".js-custom-secret-scanning-pattern-form *",async function(){!window.codeEditor||h(window.codeEditor.getValue())});const M=a((t,e,r)=>{const o=document.createElement("input");o.type="hidden",o.name=e,o.id=`${e}_hidden`,o.value=r,t.appendChild(o),o.required=!0},"createHiddenInputField"),h=v(function(t){const e=document.querySelector(".js-custom-pattern-submit-button"),r=document.querySelector(".js-save-and-dry-run-button");if(!(e instanceof HTMLElement))return;const o=document.querySelector(".js-update-pattern-info"),n=document.querySelector(".js-test-pattern-matches");if(!!n)if(t.length===0)e.setAttribute("disabled","true"),r==null||r.setAttribute("disabled","true"),n.textContent="";else{window.codeEditor.save();const s=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(s instanceof HTMLFormElement))return;const c=document.querySelector(".js-custom-secret-scanning-pattern-form");if(!(c instanceof HTMLFormElement))return;for(const i of c.elements)if(i instanceof HTMLInputElement&&i.name&&(i.type==="text"||i.type==="radio"&&i.checked)){const d=document.getElementById(`${i.name}_hidden`);d!==null&&d.remove(),M(s,i.name,i.value)}k(s,F(c,e,r,o),N(n))}},300),N=a(t=>e=>{if(e.length===0)t.textContent=" - No matches";else if(e.length===1)t.textContent=" - 1 match";else{const r=[];for(const s of e)r.push(JSON.stringify(s));const n=[...new Set(r)];t.textContent=` - ${n.length} matches`}},"getTestLabelUpdater"),F=a((t,e,r,o)=>n=>{var s,c;if(T(t),n==null?void 0:n.message){if(e.setAttribute("disabled","true"),r==null||r.setAttribute("disabled","true"),o)o.hidden=!0;else if((n==null?void 0:n.error_type)==="START_DELIMITER"||(n==null?void 0:n.error_type)==="END_DELIMITER"||(n==null?void 0:n.error_type)==="MUST_MATCH"||(n==null?void 0:n.error_type)==="MUST_NOT_MATCH"){const i=document.querySelector(".js-more-options.js-details-container");i&&(i.classList.add("open"),i.classList.add("Details--on"))}return I(t,n),!1}else{const i=document.querySelector(".js-mode");if(!i)return!1;const d=document.querySelector(".js-dry-run-status");return d?((((s=d.textContent)==null?void 0:s.toLowerCase())==="cancelled"||((c=i.textContent)==null?void 0:c.toLowerCase())!=="unpublished")&&e.removeAttribute("disabled"),r==null||r.removeAttribute("disabled"),o&&(o.hidden=!1),!0):!1}},"getTestErrorHandler");function I(t,e){var r;if(e.error_type==="MUST_MATCH"||e.error_type==="MUST_NOT_MATCH"){let o=0;const n=t.getElementsByClassName("js-additional-secret-format");for(const s of n){if(o>(e.error_index||0))return;const i=[...s.getElementsByTagName("input")].filter(p=>p.checked),d=i&&((r=i[0])==null?void 0:r.value.toUpperCase()),S=d===e.error_type&&o===e.error_index,x=[...s.getElementsByTagName("input")].filter(p=>p.type==="text");if(!x||x.length===0)continue;const l=x[0];if(l.value!=="")if(S){const p=l.id;l&&l.parentElement&&E(l.parentElement);const g=document.createElement("p"),q=`${p}_error_message`;g.classList.add("note","error","mt-5"),g.id=q,g.textContent=e.message,l==null||l.setAttribute("aria-describedby",q),l==null||l.insertAdjacentElement("afterend",g);return}else d===e.error_type&&o++}}else{const o=B[e.error_type],n=document.querySelector(`#${o}`);n&&n.parentElement&&E(n.parentElement);const s=document.createElement("p"),c=`${o}_error_message`;s.classList.add("note","error"),s.id=c,s.textContent=e.message,n==null||n.setAttribute("aria-describedby",c),n==null||n.insertAdjacentElement("afterend",s)}}a(I,"showInputErrorState");function T(t){var e,r;const o=document.querySelector(".js-error-banner");o.hidden=!0;for(const n of t.getElementsByTagName("input"))if((e=n.parentElement)==null?void 0:e.classList.contains("errored")){C(n.parentElement);const s=n.getAttribute("aria-describedby");(r=document.querySelector(`#${s}`))==null||r.remove()}}a(T,"clearInputErrorState");function f(){const t=document.querySelector(".js-post-processing-expression-max-count");if(!t)return 5;const e=t.textContent;return e?parseInt(e):5}a(f,"getMaxPostProcessingExpressions");function E(t){t==null||t.classList.add("form-group","errored","my-0")}a(E,"addErrorStylingToInput");function C(t){t==null||t.classList.remove("form-group","errored","my-0")}a(C,"removeErrorStylingFromInput");function b(){if(!window.codeEditor)return;const t=window.codeEditor.posFromIndex(0),e=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const r of window.codeEditor.findMarks(t,e))r.clear()}a(b,"clearCodeHighlights");const B={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function k(t,e,r){let o;try{const n=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});n.ok&&(o=await n.json())}catch{}if(o&&e(o.error))if(o.has_matches){const n=JSON.parse(o.matches);b(),r(n);for(const s of n){const c=window.codeEditor.posFromIndex(s.start),i=window.codeEditor.posFromIndex(s.end);window.codeEditor.markText(c,i,{className:"text-bold hx_keyword-hl rounded-1 d-inline-block"})}}else r([]),b()}a(k,"updatePatternMatches")}}});
//# sourceMappingURL=scanning-b65b0cd3.js.map
